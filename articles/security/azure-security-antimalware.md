<properties
   pageTitle="Antimalware da Microsoft para serviços de nuvem Azure e máquinas virtuais | Microsoft Azure"
   description="Este artigo fornece uma visão geral da arquitetura de Antimalware da Microsoft Azure, incluindo cenários com suporte e configurações para habilitando, configurando e implantando proteção para serviços de nuvem do Azure e máquinas virtuais. Abordaremos configuração básica, gerenciamento e funcionalidade acessível através do Microsoft Azure serviço Gerenciamento API, scripts do PowerShell, o portal do Azure e Visual Studio de monitoramento."
   services="security"
   documentationCenter="na"
   authors="YuriDio"
   manager="swadhwa"
   editor=""/>

<tags
   ms.service="security"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="09/19/2016"
   ms.author="yurid"/>

#<a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Antimalware da Microsoft para serviços de nuvem Azure e máquinas virtuais

O cenário de ameaças moderna para ambientes de nuvem é muito dinâmico, aumentando a pressão em TI empresarial nuvem assinantes para manter a proteção efetiva para atender aos requisitos de segurança e conformidade. Antimalware da Microsoft para serviços de nuvem do Azure e máquinas virtuais é o recurso de proteção em tempo real gratuito que ajuda a identificar e remover vírus, spyware e outros softwares mal-intencionados, com alertas configuráveis quando conhecido software mal-intencionado ou indesejado tenta instalar ou executar nos sistemas Azure.

A solução baseia-se na mesma plataforma antimalware como Microsoft Security Essentials \[MSE\], proteção de ponto de extremidade do Microsoft Forefront, proteção de ponto de extremidade do Microsoft System Center, Windows Intune e o Windows Defender para Windows 8.0 e superior. Antimalware da Microsoft Azure é uma solução de único agente para aplicativos e ambientes de locatário, projetados para ser executado em segundo plano sem a intervenção. Você pode implantar proteção com base nas necessidades da sua cargas de trabalho do aplicativo, com qualquer básica seguro por padrão ou configuração personalizada, incluindo monitoramento de antimalware avançada.

Quando você implantar e ativar Antimalware da Microsoft Azure para seus aplicativos, os seguintes recursos principais estão disponíveis:

- **Proteção em tempo real** - atividade de monitores em serviços de nuvem e nas máquinas virtuais para detectar e impedir a execução de malware.
- **Varredura programada** - periodicamente efetua varredura direcionados para detectar malware, incluindo ativamente programas em execução.
- **Correção de Malware** - automaticamente age em malware detectado, como excluir ou colocar em quarentena arquivos mal-intencionados e limpando entradas de registro mal-intencionados.
- **Atualizações de assinatura** - instala automaticamente as assinaturas de proteção mais recentes (definições de vírus) para garantir a proteção está atualizada em uma frequência predeterminada.
- **Atualizações de mecanismo Antimalware** – atualiza automaticamente o mecanismo de Antimalware da Microsoft.
- **Atualizações de plataforma de Antimalware** – atualiza automaticamente a plataforma de Antimalware da Microsoft.
- **Proteção ativa** - relatórios de telemetria metadados sobre ameaças detectadas e recursos suspeitos Microsoft Azure para garantir resposta rápida para o desenvolvimento de cenário de ameaças, bem como permitindo a entrega de assinatura síncrono em tempo real através do Microsoft Active proteção (mapas do sistema).
- **Exemplos de relatório** - fornece relatórios e exemplos para o serviço de Antimalware da Microsoft para ajudar a refinar o serviço e habilite a solução de problemas.
- **Exclusões** – permite que aplicativos e administradores de serviços para configurar determinados arquivos, processos e unidades para excluí-los de proteção e verificação de desempenho e/ou outros motivos.
- **Coleta de eventos de Antimalware** - registra a integridade do serviço de antimalware, atividades suspeitas e ações de correção tomadas no log de eventos do sistema operacional e reúne-las em conta de armazenamento do Azure do cliente.

> [AZURE.NOTE] Microsoft Antimalware também pode ser implantado usando o Centro de segurança do Azure. Para mais informações, leia [Instalar proteção de ponto de extremidade no Centro de segurança do Azure](../security-center/security-center-install-endpoint-protection.md) . 

##<a name="architecture"></a>Arquitetura

O Antimalware da Microsoft para solução de serviços de nuvem do Azure e máquinas virtuais inclui o serviço, modelo de implantação clássico de Antimalware, cmdlets do Antimalware PowerShell e extensão de diagnóstico do Azure e Antimalware cliente Microsoft. A solução Microsoft Antimalware tem suporte no Windows Server 2008 R2, Windows Server 2012 e famílias de sistemas operacionais Windows Server 2012 R2. Ela não é suportada no sistema operacional Windows Server 2008. No momento, não há suporte para visualização técnica do Windows Server e pretendemos suportá-lo no futuro.

O cliente de Antimalware da Microsoft e o serviço é instalado por padrão em um estado desabilitado em todas as famílias de sistema operacional de convidado Azure com suporte na plataforma de serviços de nuvem. O cliente de Antimalware da Microsoft e o serviço não é instalado por padrão na plataforma máquinas virtuais e está disponível como um recurso opcional através do portal do Azure e configuração do Visual Studio Virtual Machine em extensões de segurança.

Ao usar sites do Azure, o serviço subjacente que hospeda o aplicativo web tem Antimalware da Microsoft habilitada. Isso é usado para proteger a infraestrutura de sites do Azure e não é executado no conteúdo de cliente. 


###<a name="microsoft-antimalware-workflow"></a>Fluxo de trabalho do Microsoft antimalware

O administrador do serviço Azure pode habilitar Antimalware Azure com um padrão ou configuração personalizada para máquinas virtuais e serviços de nuvem usando as seguintes opções:

-   Máquinas virtuais – no portal do Azure, em **Extensões de segurança**

-   Máquinas virtuais – usando a configuração de máquinas virtuais do Visual Studio no Explorador de servidor

-   Máquinas virtuais e serviços de nuvem – usando o Antimalware [modelo clássico de implantação](https://msdn.microsoft.com/library/azure/ee460799.aspx)

-   Serviços de nuvem – cmdlets do PowerShell usando de Antimalware e máquinas virtuais

O portal do Azure ou os cmdlets do PowerShell push o arquivo de pacote de extensão de Antimalware no sistema Azure em um local fixo predeterminado. O Azure convidado agente (ou do tecidos) inicia a extensão de Antimalware, aplicando as configurações de Antimalware fornecidas como entrada. Esta etapa permite que o serviço de Antimalware com configurações personalizadas ou padrão. Se nenhuma configuração personalizada for fornecida, o serviço de antimalware é habilitado com as configurações padrão. Consulte a seção *configuração de Antimalware* no [Antimalware da Microsoft para serviços de nuvem do Azure e máquinas virtuais – exemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para serviços de nuvem Azure e exemplos de código de VMs") para obter mais detalhes.

Após a execução, o cliente Microsoft Antimalware baixa as definições mais recentes de mecanismo e assinatura de proteção da Internet e carrega-los no sistema Azure. O serviço de Antimalware da Microsoft grava eventos relacionados a serviço no log de eventos do sistema sistema operacional sob a origem do evento "Antimalware da Microsoft". Eventos incluem o estado de integridade do cliente de Antimalware, status de proteção e correção, configurações novas e antigas, atualizações de mecanismo e definições de assinatura e outras pessoas.

Você pode ativar o monitoramento de Antimalware para o seu serviço de nuvem ou máquina Virtual para os eventos de log de eventos de Antimalware escrito como eles são produzidos à sua conta de armazenamento do Azure. O Antimalware Service usa a extensão de diagnóstico do Azure para coletar eventos de Antimalware de sistema do Azure em tabelas na conta de armazenamento do Azure do cliente.

O fluxo de trabalho de implantação incluindo etapas de configuração e opções de suporte para os cenários acima estão documentadas na seção de [cenários de implantação de Antimalware](#_Antimalware_Deployment_Scenarios) deste documento.

![Antimalware da Microsoft no Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [AZURE.NOTE] No entanto, você pode usar o Powershell/APIs e modelos do Gerenciador de recursos do Azure para implantar conjuntos de escala de máquina Virtual com a extensão Microsoft antimalware.  Para instalar uma extensão em uma máquina Virtual já em execução, você pode usar o de script de python do exemplo *vmssextn.py* localizado [aqui](https://github.com/gbowerman/vmsstools). Esse script obtém a configuração de extensão existentes no conjunto de escala e adiciona uma extensão à lista de extensões existentes nos conjuntos de escala de máquina virtual.

###<a name="default-and-custom-antimalware-configuration"></a>Configuração de Antimalware personalizadas e padrão

As configurações padrão são aplicadas para habilitar Antimalware para serviços de nuvem do Azure ou máquinas virtuais quando você não fornecer configurações personalizadas. As configurações padrão foram previamente otimizadas para execução no ambiente do Azure. Opcionalmente, você pode personalizar essas configurações padrão conforme necessário para seu aplicativo do Azure ou implantação de serviço e aplicá-las para outros cenários de implantação.

> [AZURE.NOTE] Por padrão que a Interface de usuário do Microsoft Antimalware no Gerenciador de recursos do Azure está desabilitada, arquivo de [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) para ignorar essa mensagem de erro não é suportado. Para obter informações sobre como criar uma política personalizada, leia [Habilitar Interface de usuário do Microsoft Antimalware na implantação do Azure recurso Gerenciador VMs postagem](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/). 

A tabela a seguir resume as configurações disponíveis para o serviço de Antimalware. As configurações padrão são marcadas na coluna denominada "Padrão" abaixo.

![Tabela 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

##<a name="antimalware-deployment-scenarios"></a>Cenários de implantação de antimalware

Os cenários para habilitar e configurar o antimalware, incluindo monitoramento para serviços de nuvem do Azure e máquinas virtuais, são discutidos nesta seção.

###<a name="virtual-machines---enable-and-configure-antimalware"></a>Máquinas virtuais - habilitar e configurar o antimalware

**Implantação usando o Portal do Azure**

Para ativar o serviço de Antimalware, clique em **Adicionar** na lâmina extensões, selecione **Antimalware da Microsoft** no blade recurso novo, clique em **criar** na lâmina Antimalware da Microsoft. Clique em **criar** sem inserindo quaisquer valores de configuração para habilitar Antimalware com as configurações padrão ou insira as configurações de Antimalware da máquina Virtual configurado como mostrado na Figura 2 abaixo. Consulte as **dicas de ferramentas** fornecidos com cada configuração na lâmina Adicionar extensão para ver os valores de configuração suportada.

![Definições de configuração de máquina virtual para Antimalware da Microsoft](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**Implantação usando o portal de clássico Azure**

Para habilitar e configurar Antimalware da Microsoft para máquinas virtuais do Azure usando o portal de Azure ao provisionar uma máquina Virtual, siga as etapas abaixo:

1. Faça logon no portal do Azure em <https://portal.azure.com>

2. para criar uma nova máquina virtual, clique em **novo**, **Calcular**, **Virtual** **Machine**, **Da Galeria** (não use criação rápida) conforme mostrado abaixo:

![Nova Máquina Virtual](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)


3. Selecione a imagem do **Microsoft Windows Server** na página **Escolher uma imagem** .

4. Clique na seta à direita e a configuração de máquina Virtual de entrada.

5. Marque a caixa de seleção **Antimalware da Microsoft** em **Extensões de segurança** na página de configuração de máquina Virtual.

6. Clique no botão Enviar para habilitar e configurar o Microsoft Antimalware para máquinas virtuais do Azure com as configurações padrão.

![Configuração de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**Implantação usando a configuração de máquina virtual do Visual Studio**

Para habilitar e configurar o serviço de Antimalware da Microsoft usando o Visual Studio:

1. se conecte ao Microsoft Azure no Visual Studio.

2. Escolha sua máquina Virtual no nó **máquinas virtuais** no **Server Explorer**

![Configuração de máquina virtual no Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3. Clique com botão direito **Configurar** para exibir a página de configuração de máquina Virtual

4. Selecione extensão de **Antimalware da Microsoft** na lista suspensa em **Extensões instalado** e clique em **Adicionar** para configurar com configuração de antimalware padrão.

![Extensões instaladas](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5. para personalizar a configuração de Antimalware padrão, selecione (realce) o Antimalware extensão na lista Extensões instalados e clique em **Configurar**.

6. Substitua a configuração padrão do Antimalware a sua configuração personalizada no formato JSON com suporte na caixa de texto **configuração pública** e clique em Okey.

7. Clique no botão de **atualização** para enviar as atualizações de configuração para sua máquina Virtual.

![Extensão de configuração de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**Observação:** A configuração de máquinas de virtuais do Visual Studio para Antimalware suporta somente a configuração de formato JSON. O modelo de configurações de configuração de Antimalware JSON está incluído no [Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código"), mostrando as configurações de Antimalware com suporte.

**Cmdlets do PowerShell usando de implantação**

Um aplicativo do Azure ou serviço pode habilitar e configurar Antimalware da Microsoft para máquinas virtuais do Azure usando cmdlets do PowerShell.

Para habilitar e configurar o Microsoft antimalware usando cmdlets do PowerShell antimalware:

1. Configurar seu ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-powershell>

2. Use o cmdlet Set-AzureVMMicrosoftAntimalwareExtension Antimalware para habilitar e configurar o Microsoft Antimalware para sua máquina Virtual conforme documentadas em <http://msdn.microsoft.com/library/azure/dn771718.aspx>

**Observação:** A configuração de máquinas virtuais do Azure para Antimalware suporta somente a configuração de formato JSON. O modelo de configurações de configuração de Antimalware JSON está incluído no [Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código"), mostrando as configurações de Antimalware com suporte.

###<a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Habilitar e configurar o Antimalware usando o PowerShell cmdlets

Um aplicativo do Azure ou serviço pode habilitar e configurar Antimalware da Microsoft para serviços de nuvem do Azure usando cmdlets do PowerShell. Observe que Antimalware da Microsoft estiver instalado em um estado desabilitado na plataforma de serviços de nuvem e exige uma ação por um aplicativo do Azure para ativá-lo.

Para habilitar e configurar o Microsoft Antimalware usando cmdlets do PowerShell:

1.  Configurar seu ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-sdk-tools#get-started>

2.  Use o cmdlet Set-AzureServiceAntimalwareExtension Antimalware para habilitar e configurar o Microsoft Antimalware para seu serviço de nuvem como documentadas em <http://msdn.microsoft.com/library/azure/dn771718.aspx>

O modelo de configurações de configuração de Antimalware XML está incluído no [Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código"), mostrando as configurações de Antimalware com suporte.

###<a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Serviços em nuvem e máquinas virtuais - cmdlets do PowerShell usando de configuração

Um aplicativo do Azure ou serviço pode recuperar a configuração de Antimalware da Microsoft para serviços de nuvem e máquinas virtuais usando cmdlets do PowerShell.

Para recuperar a configuração de Antimalware da Microsoft usando cmdlets do PowerShell:

1.  Configurar seu ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **Para máquinas virtuais**: Use o cmdlet Get-AzureVMMicrosoftAntimalwareExtension Antimalware para obter a configuração de antimalware conforme documentadas em <http://msdn.microsoft.com/library/azure/dn771719.aspx>

3.  **Para serviços de nuvem**: Use o cmdlet Get-AzureServiceAntimalwareConfig Antimalware para obter a configuração de Antimalware conforme documentadas em <http://msdn.microsoft.com/library/azure/dn771722.aspx>

###<a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Remover cmdlets do PowerShell Antimalware configuração usando

Um aplicativo do Azure ou serviço pode remover a configuração de Antimalware e qualquer configuração de monitoramento Antimalware associada da relevantes Antimalware do Azure e o diagnóstico de extensões de serviços da associado ao serviço de nuvem ou máquina Virtual.

Para remover Antimalware da Microsoft usando cmdlets do PowerShell:

1.  Configurar seu ambiente do PowerShell - consulte a documentação em <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **Para máquinas virtuais**: Use o cmdlet de Antimalware remover AzureVMMicrosoftAntimalwareExtension como documentadas em <http://msdn.microsoft.com/library/azure/dn771720.aspx>

3.  **Para serviços de nuvem:** Usar o cmdlet de Antimalware remover AzureServiceAntimalwareExtension como documentadas em <http://msdn.microsoft.com/library/azure/dn771717.aspx>

Para **Habilitar** o conjunto de eventos de antimalware para uma máquina virtual usando o Portal de visualização do Azure:

1.  Clique em qualquer parte da lente monitoramento na máquina Virtual lâmina

2.  Clique no comando de diagnóstico na lâmina métrica

3.  Selecione o **Status** ativado e marque a opção para o sistema de eventos do Windows 
4.  . Você pode optar por desmarque todas as outras opções na lista ou deixá-los habilitado por suas necessidades de serviço de aplicativo.

4.  As categorias de eventos de Antimalware "Erro", "Aviso", "Informativo", etc., são capturadas em sua conta de armazenamento do Azure.

Eventos de antimalware são coletados dos logs de sistema de eventos do Windows à sua conta de armazenamento do Azure. Você pode configurar a conta de armazenamento para sua máquina Virtual coletar eventos de Antimalware selecionando a conta de armazenamento apropriado.

![Diagnósticos e métricas](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [AZURE.NOTE] Para obter mais informações sobre como o log de diagnóstico do Azure Antimalware, leia [Habilitando o log de diagnóstico para Antimalware do Azure](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

###<a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Habilitar e configurar o monitoramento de antimalware usando cmdlets do powerShell

Você pode habilitar a coleção de eventos de Antimalware da Microsoft para seu serviço de nuvem ou máquina Virtual usando o diagnóstico do Azure por meio de cmdlets do Antimalware PowerShell. A extensão de diagnóstico do Azure pode ser configurada para capturar eventos na origem de log de eventos do sistema "Antimalware da Microsoft" à sua conta de armazenamento do Azure. As categorias de eventos de Antimalware "Erro", "Aviso", "Informativo", etc., são capturadas em sua conta de armazenamento do Azure.

Para habilitar a coleta de eventos de Antimalware à sua conta de armazenamento do Azure usando cmdlets do PowerShell:

1.  Configurar seu ambiente do PowerShell - consulte <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **Para máquinas virtuais** - usar o cmdlet Set-AzureVMMicrosoftAntimalwareExtension Antimalware com opção de monitoramento ativado como documentadas em <http://msdn.microsoft.com/library/azure/dn771716.aspx>

3.  **Para serviços de nuvem** - usar o cmdlet Set-AzureServiceAntimalwareExtension Antimalware com opção de monitoramento ativado como documentadas em <http://msdn.microsoft.com/library/azure/dn771718.aspx>

Você pode exibir os eventos brutos Antimalware olhando a tabela de WADWindowsEventLogsTable na sua conta de armazenamento do Azure que você configurou para habilitar o monitoramento de Antimalware. Isso pode ser útil para validar que coleta de eventos de Antimalware estiver funcionando, incluindo percepção integridade do serviço Antimalware. Para obter mais detalhes, incluindo o código de exemplo sobre como extrair Antimalware eventos de sua conta de armazenamento, consulte [Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para serviços de nuvem Azure e máquina Virtual - exemplos de código").
